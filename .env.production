################################################################################
# Production Environment Configuration for FFmpeg API
# ВНИМАНИЕ: Замените все пароли и секреты на уникальные значения!
################################################################################

# =============================================================================
# DATABASE SETTINGS
# =============================================================================
POSTGRES_DB=ffmpeg_api_prod
POSTGRES_USER=ffmpeg_api_user
POSTGRES_PASSWORD=CHANGE_THIS_STRONG_PASSWORD_MIN_32_CHARS_LONG
# Рекомендуемый формат: openssl rand -base64 32

# =============================================================================
# REDIS SETTINGS
# =============================================================================
REDIS_URL=redis://redis:6379/0
# Redis для Celery использует отдельный DB (настроен в docker-compose.prod.yml)

# =============================================================================
# MINIO SETTINGS (Object Storage)
# =============================================================================
MINIO_ROOT_USER=MINIO_ADMIN_USER_CHANGE_THIS
MINIO_ROOT_PASSWORD=CHANGE_THIS_MINIO_PASSWORD_MIN_32_CHARS
MINIO_BUCKET_NAME=ffmpeg-files
MINIO_SECURE=true

# =============================================================================
# JWT SETTINGS (Authentication)
# =============================================================================
# Сгенерируйте секрет: openssl rand -base64 64
JWT_SECRET=CHANGE_THIS_JWT_SECRET_KEY_MINIMUM_64_CHARACTERS_LONG_USE_OPENSSL
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
ENVIRONMENT=production
LOG_LEVEL=INFO
DEBUG=false
API_V1_PREFIX=/api/v1
PROJECT_NAME=FFmpeg API Service
VERSION=1.0.0

# =============================================================================
# UPLOAD SETTINGS
# =============================================================================
MAX_UPLOAD_SIZE=1073741824
ALLOWED_VIDEO_EXTENSIONS=mp4,avi,mov,mkv,wmv,webm,mpeg,flv
ALLOWED_AUDIO_EXTENSIONS=mp3,aac,wav,flac,ogg,m4a,wma
ALLOWED_SUBTITLE_EXTENSIONS=srt,vtt,ass,ssa,smi

# =============================================================================
# STORAGE SETTINGS
# =============================================================================
STORAGE_RETENTION_DAYS=30
TEMP_DIR=/tmp/ffmpeg

# =============================================================================
# FFMPEG SETTINGS
# =============================================================================
FFMPEG_PATH=/usr/bin/ffmpeg
FFPROBE_PATH=/usr/bin/ffprobe
FFMPEG_THREADS=4
FFMPEG_PRESET=fast

# =============================================================================
# CELERY SETTINGS (Task Queue)
# =============================================================================
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/1
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=7200
CELERY_TASK_SOFT_TIME_LIMIT=6000
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_WORKER_CONCURRENCY=4

# =============================================================================
# TASK SETTINGS
# =============================================================================
MAX_RETRIES=5
RETRY_DELAY=120
TASK_TIMEOUT=7200
WORKER_TIMEOUT=7200

# =============================================================================
# MONITORING SETTINGS
# =============================================================================
ENABLE_METRICS=true
PROMETHEUS_PORT=9090

# =============================================================================
# RATE LIMITING SETTINGS
# =============================================================================
# API общий лимит (10 запросов в секунду в nginx)
RATE_LIMIT_PER_MINUTE=600
RATE_LIMIT_PER_HOUR=10000

# =============================================================================
# CORS SETTINGS
# =============================================================================
# Замените на реальные домены вашего фронтенда
CORS_ORIGINS=["https://yourdomain.com", "https://www.yourdomain.com"]

# =============================================================================
# GRAFANA SETTINGS
# =============================================================================
# Сгенерируйте пароль: openssl rand -base64 16
GRAFANA_ADMIN_PASSWORD=CHANGE_THIS_GRAFANA_PASSWORD_MIN_16_CHARS
GRAFANA_DOMAIN=yourdomain.com

# =============================================================================
# FLOWER SETTINGS (Celery Monitor)
# =============================================================================
FLOWER_USER=admin
FLOWER_PASSWORD=CHANGE_THIS_FLOWER_PASSWORD_MIN_16_CHARS

# =============================================================================
# SCALING SETTINGS
# =============================================================================
API_REPLICAS=2
WORKER_REPLICAS=2

# =============================================================================
# EMAIL SETTINGS (для уведомлений, если используются)
# =============================================================================
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-specific-password
# SMTP_FROM=noreply@yourdomain.com
# SMTP_TLS=true

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Дополнительные настройки безопасности
ALLOWED_HOSTS=["yourdomain.com", "www.yourdomain.com"]
SECURE_SSL_REDIRECT=true
SESSION_COOKIE_SECURE=true
CSRF_COOKIE_SECURE=true

# =============================================================================
# BACKUP SETTINGS (если используете бэкап)
# =============================================================================
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE="0 2 * * *"
# BACKUP_RETENTION_DAYS=30
# BACKUP_S3_BUCKET=ffmpeg-backups

# =============================================================================
# LOGGING SETTINGS
# =============================================================================
LOG_FORMAT=json
LOG_FILE=/var/log/ffmpeg-api/app.log
LOG_ROTATION_SIZE=100M
LOG_ROTATION_BACKUP_COUNT=10

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_TEXT_OVERLAYS=true
ENABLE_WATERMARKS=true
ENABLE_SUBTITLES=true
ENABLE_VIDEO_CONVERSION=true
ENABLE_AUDIO_CONVERSION=true
ENABLE_BATCH_OPERATIONS=true

# =============================================================================
# CDN SETTINGS (если используете CDN)
# =============================================================================
# CDN_ENABLED=false
# CDN_URL=https://cdn.yourdomain.com
# CDN_PROVIDER=cloudflare

# =============================================================================
# WEBHOOK SETTINGS (если используете вебхуки)
# =============================================================================
# WEBHOOK_ENABLED=false
# WEBHOOK_SECRET=CHANGE_THIS_WEBHOOK_SECRET
# WEBHOOK_URL=https://yourdomain.com/webhook

# =============================================================================
# API RATE LIMITING (приложение уровень)
# =============================================================================
# Эти настройки дополняют nginx rate limiting
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_STORAGE=redis
API_RATE_LIMIT_WINDOW_SECONDS=60
API_RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# STORAGE QUOTAS (если нужны квоты)
# =============================================================================
# USER_STORAGE_QUOTA_GB=10
# TOTAL_STORAGE_QUOTA_GB=1000
